<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>æ™ºèƒ½ç°½è³¬è»å¸« V56.0</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ç°½è³¬è»å¸«">

    <style>
        :root {
            --boc: #b31d28; --hsbc: #db0011; --hangseng: #008154;
            --sc: #006b4d; --ccb: #003b8e; --aeon: #800080;
            --citic: #ed1c24; --mox: #05d5a1;
            --miles: #004a99; --cash: #d32f2f; --bg: #f2f5f8;
        }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background: var(--bg); margin: 0; padding: env(safe-area-inset-top) 10px 30px 10px; color: #1a1a1a; }
        .container { max-width: 650px; margin: 10px auto; background: #fff; padding: 20px; border-radius: 24px; box-shadow: 0 10px 40px rgba(0,0,0,0.06); }

        /* Header */
        header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #f0f2f5; padding-bottom: 15px; }
        header h1 { margin: 0; font-size: 24px; font-weight: 800; letter-spacing: -1px; }
        header p { margin: 5px 0 0; font-size: 12px; color: #888; }

        /* åŒæ­¥ç‹€æ…‹ */
        #syncStatus { font-size: 11px; color: #aaa; text-align: center; margin-bottom: 10px; min-height: 1em; }

        /* å¡ç‰‡ç®¡ç† */
        .manager-toggle-btn { width: 100%; padding: 12px; background: #f0f2f5; border: 1px solid #ddd; border-radius: 12px; font-size: 13px; font-weight: 700; color: #555; cursor: pointer; margin-bottom: 15px; display: flex; justify-content: center; align-items: center; gap: 8px; }
        .card-manager-content { display: none; background: #fafafa; border: 1px solid #eee; border-radius: 20px; padding: 15px; margin-bottom: 20px; animation: slideDown 0.3s ease-out; }
        @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .bank-name-label { font-size: 11px; font-weight: 700; color: #aaa; text-transform: uppercase; margin: 10px 0 5px; }
        .toggle-grid { display: flex; flex-wrap: wrap; gap: 6px; }
        .toggle-card-btn { padding: 8px 12px; border-radius: 10px; border: 1.5px solid #eee; font-size: 11px; font-weight: 700; cursor: pointer; background: #fff; color: #ccc; transition: 0.2s; }
        .toggle-card-btn.active.hsbc { border-color: var(--hsbc); color: var(--hsbc); background: #fff5f5; }
        .toggle-card-btn.active.boc { border-color: var(--boc); color: var(--boc); background: #fff5f5; }
        .toggle-card-btn.active.hangseng { border-color: var(--hangseng); color: var(--hangseng); background: #f5fff5; }
        .toggle-card-btn.active.ccb { border-color: var(--ccb); color: var(--ccb); background: #f5f8ff; }
        .toggle-card-btn.active.sc { border-color: var(--sc); color: var(--sc); background: #f5fff5; }
        .toggle-card-btn.active.citic { border-color: var(--citic); color: var(--citic); background: #fff5f5; }
        .toggle-card-btn.active.mox { border-color: var(--mox); color: #111; background: #f5fff5; }
        .toggle-card-btn.active.aeon { border-color: var(--aeon); color: var(--aeon); background: #fff5ff; }

        /* æœå°‹ */
        .search-section { background: linear-gradient(135deg, #1a1a1a, #333); color: #fff; padding: 20px; border-radius: 20px; margin-bottom: 20px; }
        .search-section label { font-size: 13px; color: #bbb; display: block; margin-bottom: 8px; }
        #merchantSearch { width: 100%; padding: 15px; border-radius: 12px; border: none; font-size: 16px; font-weight: 700; outline: none; color: #000; }
        .match-hint { font-size: 13px; color: #4caf50; margin-top: 10px; font-weight: bold; min-height: 1.2em; }

        /* è¼¸å…¥ */
        .input-row { display: flex; flex-wrap: wrap; gap: 15px; margin-bottom: 15px; }
        .input-group { flex: 1; min-width: 280px; }
        label { display: block; margin-bottom: 6px; font-weight: 700; font-size: 13px; color: #555; }
        select, input[type="number"], input[type="date"] { width: 100%; padding: 12px; border: 1.5px solid #eee; border-radius: 12px; font-size: 15px; background: #fafafa; outline: none; }

        /* æ—¥æœŸç‹€æ…‹ */
        .date-status-tag { font-size: 11px; font-weight: 800; margin-top: 4px; display: inline-block; padding: 2px 6px; border-radius: 4px; }
        .is-red { background: #ffebee; color: #d32f2f; }
        .is-normal { background: #f0f0f0; color: #666; }

        /* æ”¯ä»˜åˆ‡æ› */
        .toggle-container { display: flex; gap: 5px; background: #f0f0f0; padding: 4px; border-radius: 12px; }
        .toggle-btn { flex: 1; padding: 11px 5px; border: none; border-radius: 9px; cursor: pointer; font-size: 12px; font-weight: 700; color: #666; background: none; transition: 0.2s; }
        .toggle-btn.active { background: #fff; color: #000; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }

        .analyze-btn { width: 100%; padding: 18px; background: #db0011; color: #fff; border: none; border-radius: 15px; font-size: 18px; font-weight: 800; cursor: pointer; margin-top: 10px; }

        /* çµæœ */
        .section-header { margin-top: 30px; padding-bottom: 10px; border-bottom: 2px solid #eee; font-size: 17px; font-weight: 800; }
        .section-header.miles { color: var(--miles); }
        .section-header.cash { color: var(--cash); }
        .card-box { border: 1px solid #f0f0f0; border-radius: 18px; padding: 16px; margin-top: 12px; border-left: 6px solid #ccc; background: #fff; }
        .boc-card { border-left-color: var(--boc); }
        .hsbc-card { border-left-color: var(--hsbc); }
        .hangseng-card { border-left-color: var(--hangseng); }
        .sc-card { border-left-color: var(--sc); }
        .ccb-card { border-left-color: var(--ccb); }
        .citic-card { border-left-color: var(--citic); }
        .mox-card { border-left-color: var(--mox); }
        .aeon-card { border-left-color: var(--aeon); }
        .card-top { display: flex; justify-content: space-between; align-items: flex-start; }
        .earn-val { font-size: 22px; font-weight: 900; text-align: right; letter-spacing: -0.5px; }
        .promo-tag { background: #fff3e0; color: #e65100; font-size: 10px; padding: 2px 6px; border-radius: 4px; font-weight: 800; display: inline-block; margin-top: 4px; border: 1px solid #ffe0b2; }
        .card-desc { font-size: 12px; color: #777; margin-top: 10px; border-top: 1px dashed #eee; padding-top: 10px; line-height: 1.5; }
        .remark-tip { font-size: 11px; color: #e65100; font-weight: 600; margin-top: 5px; padding: 4px 0; display: block; border-top: 1px solid #fff3e0; }

        @media (max-width: 450px) { .input-group { min-width: 100%; } }
    </style>
</head>
<body>
<div class="container">
    <header>
        <h1>ğŸ’³ æ™ºèƒ½ç°½è³¬è»å¸« V56.0</h1>
        <p>æ¨¡çµ„åŒ–é‡æ§‹ç‰ˆ | JSON é©…å‹• | Firebase é›²ç«¯åŒæ­¥</p>
    </header>

    <div id="syncStatus">ğŸ”„ åˆå§‹åŒ–ä¸­...</div>

    <button id="managerToggleBtn" class="manager-toggle-btn">âš™ï¸ ç·¨è¼¯æˆ‘çš„å¡ç‰‡æ¸…å–®</button>
    <div id="cardManagerPanel" class="card-manager-content">
        <div id="bankGroupsContainer"></div>
    </div>

    <div class="search-section">
        <label>ğŸ” æœå°‹å•†æˆ¶ (fresh, ç™¾ä½³, mtr, Apple, è¬å¯§...)</label>
        <input type="text" id="merchantSearch" placeholder="æœå°‹å•†æˆ¶åç¨±...">
        <div id="matchHint" class="match-hint"></div>
    </div>

    <div class="input-row">
        <div class="input-group">
            <label>ç•¶æœˆç´¯ç©ç°½è³¬ (HKD)</label>
            <input type="number" id="currentSpent" value="0">
        </div>
        <div class="input-group">
            <label>æœ¬æ¬¡é‡‘é¡ (HKD)</label>
            <input type="number" id="amount" placeholder="é‡‘é¡" inputmode="numeric">
        </div>
    </div>

    <div class="input-row">
        <div class="input-group">
            <label>ç°½è³¬æ—¥æœŸ (è­˜åˆ¥ç´…æ—¥çè³)</label>
            <input type="date" id="txnDate">
            <div id="dateStatus" class="date-status-tag"></div>
        </div>
        <div class="input-group">
            <label>æ”¯ä»˜æ–¹å¼</label>
            <div class="toggle-container">
                <button id="meth-ap" class="toggle-btn active">æ‰‹æ©Ÿæ”¯ä»˜</button>
                <button id="meth-on" class="toggle-btn">ç¶²ä¸Š/App</button>
            </div>
        </div>
    </div>

    <div class="input-group" style="margin-bottom:15px;">
        <label>é¡åˆ¥åˆ¤å®š (åµæ¸¬å¾Œå¯ä¿®æ­£)</label>
        <select id="category">
            <option value="General">-- ä¸€èˆ¬æœ¬åœ°æ¶ˆè²» --</option>
            <option value="Dining">ğŸ½ï¸ é¤é£²é£Ÿè‚†</option>
            <option value="Online">ğŸ›ï¸ ä¸€èˆ¬ç¶²è³¼</option>
            <option value="Electronics">ğŸ”Œ é›»å­ç”¢å“/é›»è¨Š</option>
            <option value="Super">ğŸ›’ è¶…ç´šå¸‚å ´</option>
            <option value="Transport">ğŸšŒ äº¤é€š/å«è»Š/æ²¹ç«™</option>
            <option value="Home">ğŸ  å®¶å±…ç”¨å“</option>
            <option value="Pet">ğŸ¾ å¯µç‰©è­·ç†</option>
            <option value="Leisure">ğŸ¡ ä¼‘é–’å¨›æ¨‚</option>
            <option value="Medical">ğŸ¥ é†«ç™‚æœå‹™</option>
            <option value="Travel">âœˆï¸ æ—…éŠæ©Ÿç¥¨/é…’åº—</option>
            <option value="Jewelry">ğŸ’ ç å¯¶æœé£¾</option>
            <option value="Coffee">â˜• å’–å•¡è¼•é£Ÿ</option>
            <option value="Overseas">ğŸŒ æµ·å¤–å¤–å¹£</option>
        </select>
    </div>

    <button id="analyzeBtn" class="analyze-btn">ç²¾ç¢ºé‹ç®—æœ€ä½³åˆ†çµ„æ’åº</button>

    <div id="results" style="display:none;">
        <div class="section-header miles">âœˆï¸ é‡Œæ•¸å„ªå…ˆå»ºè­° (é«˜è‡³ä½)</div>
        <div id="miles-results"></div>
        <div class="section-header cash">ğŸ’° ç¾é‡‘å›è´ˆå»ºè­° (é«˜è‡³ä½)</div>
        <div id="cash-results"></div>
    </div>
</div>

<!-- Firebase SDK (ESM) -->
<script type="module" src="./js/app.js"></script>
</body>
</html>
